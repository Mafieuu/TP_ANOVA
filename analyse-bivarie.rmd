---
title: "Analyse bivarie"
---

```{r options_communes, include=FALSE, cache=FALSE}
source("options_communes.R")
```


```{r packages, include=FALSE}
library(readr)
library(ggplot2)
library(corrplot)
library(tidyverse)
library(readr)
library(ggcorrplot)
library(lsr)
library(plotly)
library(GGally)

```
```{r setup, include=FALSE}
data <- read_delim("data/0.BASE TRAVAUX PRATIQUES ANOVA ISE2 2024-2025.csv", 
    delim = ";", 
    trim_ws = TRUE) %>%
  mutate(across(c(Couleur, Germination.epi, Enracinement, Verse, Attaque, Parcelle, Verse.Traitement), as.factor))
```

## Comparaison entre "Parcelle" et "Masse.grains"

```{r parcelle_masse,message=FALSE,warning=FALSE,echo=FALSE}


# Comparer "Parcelle" et "Masse.grains"
ggplot(data, aes(x = Parcelle, y = Masse.grains)) +
  geom_boxplot(fill = "skyblue", color = "black") +
  theme_minimal() +
  ggtitle("Comparaison de Masse des grains par Parcelle") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = "Parcelle", y = "Masse des grains")


```
On observe que 
```{r table_parcell_mass,message=FALSE,warning=FALSE,echo=FALSE}
# Fonction pour détecter les aberrations avec la méthode IQR
detect_aberrant <- function(x) {
  Q1 <- quantile(x, 0.25, na.rm = TRUE)
  Q3 <- quantile(x, 0.75, na.rm = TRUE)
  IQR <- Q3 - Q1
  lower_bound <- Q1 - 1.5 * IQR
  upper_bound <- Q3 + 1.5 * IQR
  return(x < lower_bound | x > upper_bound)
}
# DataFrame pour "Parcelle"
tableau_parcelle <- data %>%
  mutate(
    Masse_grains_missing = is.na(Masse.grains),  # Valeurs manquantes
    Masse_grains_aberrant = detect_aberrant(Masse.grains)  # Valeurs aberrantes
  ) %>%
  select(Individu, Parcelle, Masse.grains, Masse_grains_missing, Masse_grains_aberrant) %>%
  filter(Masse_grains_missing | Masse_grains_aberrant)  

knitr::kable(tableau_parcelle, caption = "informations du parcelle en fonction de la masse",row.names = FALSE)

```

## Comparaison entre "couleur " et "Masse.grains"

```{r couleur_masse,message=FALSE,warning=FALSE,echo=FALSE}


# Comparer "Parcelle" et "Masse.grains"
ggplot(data, aes(x = Couleur, y = Masse.grains)) +
  geom_boxplot(fill = "orange", color = "black") +
  theme_minimal() +
  ggtitle("Comparaison de Masse des grains par couleur") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = "couleur", y = "Masse des grains")


```
On observe que 
```{r table_couleur_mass,message=FALSE,warning=FALSE,echo=FALSE}

# DataFrame pour "couleur"
tableau_parcelle <- data %>%
  mutate(
    Masse_grains_missing = is.na(Masse.grains),  # Valeurs manquantes
    Masse_grains_aberrant = detect_aberrant(Masse.grains)  # Valeurs aberrantes
  ) %>%
  select(Individu, Couleur, Masse.grains, Masse_grains_missing, Masse_grains_aberrant) %>%
  filter(Masse_grains_missing | Masse_grains_aberrant)  

knitr::kable(tableau_parcelle, caption = "informations de la couleur en fonction de la masse",row.names = FALSE)

```

## Comparaison entre "épigité de la germination " et "Masse.grains"

```{r epi_masse,message=FALSE,warning=FALSE,echo=FALSE}


# Comparer "Germination.epi" et "Masse.grains"
ggplot(data, aes(x = Germination.epi, y = Masse.grains)) +
  geom_boxplot(fill = "darksalmon", color = "black") +
  theme_minimal() +
  ggtitle("Comparaison de Masse des grains par Germination.epi") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = "est épi", y = "Masse des grains")


```
On observe que 
```{r table_Germination.epi_mass,message=FALSE,warning=FALSE,echo=FALSE}

# DataFrame pour "Germination.epi"
tableau_parcelle <- data %>%
  mutate(
    Masse_grains_missing = is.na(Masse.grains),  # Valeurs manquantes
    Masse_grains_aberrant = detect_aberrant(Masse.grains)  # Valeurs aberrantes
  ) %>%
  select(Individu, Germination.epi, Masse.grains, Masse_grains_missing, Masse_grains_aberrant) %>%
  filter(Masse_grains_missing | Masse_grains_aberrant)  

knitr::kable(tableau_parcelle, caption = "informations d'épigité de la graine en fonction de la masse",row.names = FALSE)

```

## Comparaison entre "Enracinement" et "Masse.grains"

```{r enracinement_masse,message=FALSE,warning=FALSE,echo=FALSE}


# Comparer "Enracinement" et "Masse.grains"
ggplot(data, aes(x = Enracinement, y = Masse.grains)) +
  geom_boxplot(fill = "gold", color = "black") +
  theme_minimal() +
  ggtitle("Comparaison de Masse des grains par Enracinement") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = "Enracinement", y = "Masse des grains")


```
On observe que 
```{r table_Enracinement_mass,message=FALSE,warning=FALSE,echo=FALSE}

# DataFrame pour "Germination"
tableau_Enracinement <- data %>%
  mutate(
    Masse_grains_missing = is.na(Masse.grains),  # Valeurs manquantes
    Masse_grains_aberrant = detect_aberrant(Masse.grains)  # Valeurs aberrantes
  ) %>%
  select(Individu, Enracinement, Masse.grains, Masse_grains_missing, Masse_grains_aberrant) %>%
  filter(Masse_grains_missing | Masse_grains_aberrant)  

knitr::kable(tableau_Enracinement, caption = "informations d'Enracinement en fonction de la masse",row.names = FALSE)

```

## Comparaison entre "courbure (verse) de la plante" et "Masse.grains"

```{r verse_masse,message=FALSE,warning=FALSE,echo=FALSE}


# Comparer "Verse" et "Masse.grains"
ggplot(data, aes(x = Verse, y = Masse.grains)) +
  geom_boxplot(fill = "darkslategray1", color = "black") +
  theme_minimal() +
  ggtitle("Comparaison de Masse des grains par Verse") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = "Verse", y = "Masse des grains")


```
On observe que 
```{r table_Verse_mass,message=FALSE,warning=FALSE,echo=FALSE}

# DataFrame pour "Verse"
tableau_Verse <- data %>%
  mutate(
    Masse_grains_missing = is.na(Masse.grains),  # Valeurs manquantes
    Masse_grains_aberrant = detect_aberrant(Masse.grains)  # Valeurs aberrantes
  ) %>%
  select(Individu, Verse, Masse.grains, Masse_grains_missing, Masse_grains_aberrant) %>%
  filter(Masse_grains_missing | Masse_grains_aberrant)  

knitr::kable(tableau_Verse, caption = "informations de Verse en fonction de la masse",row.names = FALSE)

```

## Comparaison entre "  est attaqué par des insectes" et "Masse.grains"

```{r attaque_masse,message=FALSE,warning=FALSE,echo=FALSE}


# Comparer "Attaque" et "Masse.grains"
ggplot(data, aes(x = Attaque, y = Masse.grains)) +
  geom_boxplot(fill = "darkorchid4", color = "black") +
  theme_minimal() +
  ggtitle("Comparaison de Masse des grains par Attaque") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = "Attaque", y = "Masse des grains")

```
On observe que 
```{r table_attaque_mass,message=FALSE,warning=FALSE,echo=FALSE}

# DataFrame pour "Attaque"
tableau_Attaque <- data %>%
  mutate(
    Masse_grains_missing = is.na(Masse.grains),  # Valeurs manquantes
    Masse_grains_aberrant = detect_aberrant(Masse.grains)  # Valeurs aberrantes
  ) %>%
  select(Individu, Attaque, Masse.grains, Masse_grains_missing, Masse_grains_aberrant) %>%
  filter(Masse_grains_missing | Masse_grains_aberrant)  

knitr::kable(tableau_Attaque, caption = "informations d'Attaque en fonction de la masse",row.names = FALSE)
```

## Comparaison entre "  la courbure est traité" et "Masse.grains"

```{r Verse.Traitement_masse,message=FALSE,warning=FALSE,echo=FALSE}


# Comparer "Verse.Traitement" et "Masse.grains"
ggplot(data, aes(x = Verse.Traitement, y = Masse.grains)) +
  geom_boxplot(fill = "deepskyblue", color = "black") +
  theme_minimal() +
  ggtitle("Comparaison de Masse des grains par Verse.Traitement") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = "Verse.Traitement", y = "Masse des grains")

```
On observe que 
```{r table_Verse.Traitement_mass,message=FALSE,warning=FALSE,echo=FALSE}

# DataFrame pour "Verse.Traitement"
tableau_Attaque <- data %>%
  mutate(
    Masse_grains_missing = is.na(Masse.grains),  # Valeurs manquantes
    Masse_grains_aberrant = detect_aberrant(Masse.grains)  # Valeurs aberrantes
  ) %>%
  select(Individu, Verse.Traitement, Masse.grains, Masse_grains_missing, Masse_grains_aberrant) %>%
  filter(Masse_grains_missing | Masse_grains_aberrant)  

knitr::kable(tableau_Attaque, caption = "informations courbure traité en fonction de la masse",row.names = FALSE)
```

## Etude de correlation entre les variables qualitatives 

